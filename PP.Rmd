---
title: "Prix de vente de maisons à King County"
author: "Matis Brassard-Verrier, Alyson Marquis, Alexis Picard et Samuel Provencher"
output:
     powerpoint_presentation:
        reference_doc : Presentation1.pptx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source("script.R")
source("1-ModeleBase.R")
source("2-Lasso.R")
source("3-K_voisin.R")
source("4-Arbre.R")
load("save.Rdata")
load("save2.Rdata")
load("save3.Rdata")
```

## Introduction


## Plan de la présentation

- Base de données à l'étude
- Prétraitement des données
- Analyse exploratoire
- Modèles testés
- Comparaison des modèles
- Forêt aléatoire
- GBM

## Base de données à l'étude


## Prétraitement des données

```{r pressure}
plot(pressure)
```

## Analyse en composantes principales

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Visualisation contributions des 4 composantes
contrib_corrige <- data.frame(acp_corrige$var$coord[,1:4])
contrib_corrige$carac <- rownames(contrib_corrige)
contrib.long_corrige <- reshape2::melt(contrib_corrige)

ggplot(contrib.long_corrige, aes(x=carac, fill=variable, y=value))+
    geom_bar(stat="identity",position=PositionDodge)+
    facet_grid(~variable)+
    theme(legend.position="none",axis.text.x = element_text(angle = 90))+
    coord_flip()+labs(title = "Contributions des variables aux 4 premières composantes") +
  theme(plot.title = element_text(size = rel(0.8))) +
  ylab("Contribution") +
  xlab("Variable")

```

## Analyse exploratoire

## Modèles testés

- Modèle de base
- Modèle linéaire généralisé avec régression Lasso
- Modèle des *k* plus proches voisins
- Arbre de décision
- Ensemble d'arbres de décision agrégées par *bagging*
- Forêt aléatoire
- Modèle de *gradient boosting*

## Modèles testés - Modèle de base

## Modèles testés - Modèle linéaire généralisé avec régression Lasso

## Modèles testés - Modèle des *k* plus proches voisins

## Modèles testés - Arbre de décision

## Modèles testés - Ensemble d'arbres de décision agrégées par *bagging*

## Modèle testés - Forêt aléatoire

## Modèles testés - Modèle de *gradient boosting*

## Comparaison des modèles

```{r echo=FALSE}
library(knitr)

dataframe <- data.frame(c("Modèle de base", "Modèle Lasso", "K plus proches voisins","Arbre de décision","Bagging","Forêt aléatoire", "Gradient boosting (GBM)"), c(EQM.ModBase,msep.lasso, EQM.Kvoisins, EQM.arbre, EQM.bag,EQM.foret,3))

kable(dataframe, caption = "L'EQM des sept modèles testés", col.names = c("Modèles","EQM"), digits = 5)
```

## Forêt aléatoire

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(randomForest)
varImpPlot(foret, main="Graphique X: Importance des variables composant la forêt aléatoire")
```

## Forêt aléatoire (suite)

## Forêt aléatoire (suite)

## Forêt aléatoire (suite)


## Modèle de *gradient boosting*


## Bibliographie

1. Kaggle, harlfoxen (2017). House sales in King County, USA. Récupéré le 27 février 2020 de https://www.kaggle.com/harlfoxem/housesalesprediction.
\newline
2. Max Kuhn (2020). caret: Classification and Regression Training. R package version 6.0-85. https://CRAN.R-project.org/package=caret
\newline
3. Terry Therneau and Beth Atkinson (2019). rpart: Recursive Partitioning and Regression Trees. R package version 4.1-15. https://CRAN.R-project.org/package=rpart
\newline
4. Stephen Milborrow (2019). rpart.plot: Plot 'rpart' Models: An Enhanced Version of 'plot.rpart'. R package version 3.0.8. https://CRAN.R-project.org/package=rpart.plot

## Bibliographie

5. A. Liaw and M. Wiener (2002). Classification and Regression by randomForest. R News 2(3), 18--22.
\newline
6. Brandon Greenwell, Bradley Boehmke, Jay Cunningham and GBM Developers (2019). gbm: Generalized Boosted Regression Models. R package version 2.1.5. https://CRAN.R-project.org/package=gbm
\newline
7. Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent. Journal of Statistical Software, 33(1), 1-22. URL http://www.jstatsoft.org/v33/i01/.
\newline
8. Alina Beygelzimer, Sham Kakadet, John Langford, Sunil Arya, David Mount and Shengqiao Li (2019). FNN: Fast Nearest Neighbor Search Algorithms and Applications. R package
version 1.1.3.  https://CRAN.R-project.org/package=FNN
